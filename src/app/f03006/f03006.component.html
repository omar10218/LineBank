<!-- 頁面背景 -->
<div class="line_bank_bankground_color">
  <div style="padding-left: 20px; padding-top: 20px;">
    <button nz-button [nzSize]="'large'" nzType="primary" (click)="addNew()">新增</button>
    <button nz-button [nzSize]="'large'" nzType="primary" (click)="changeSelect()">查詢</button>
    <button nz-button [nzSize]="'large'" nzType="primary" (click)="Clear()">清除資料</button>
  </div>
  <br>

  <div class="line_bank_card_no_padding">
    <div class="line_bank_form_header_title">組織人員維護</div>

    <div nz-row>
      <div nz-col nzSpan="6">
        <div style="padding:10px"><span class="form-title">員工編號：</span><input style="display: block;"
            [(ngModel)]="empNoValue" name="empNoValue"></div>
      </div>
      <div nz-col nzSpan="6">
        <div style="padding:10px"><span class="form-title">員工姓名：</span><input style="display: block;"
            [(ngModel)]="empNameValue" name="empNameValue"></div>
      </div>
      <div nz-col nzSpan="6">
        <div style="padding:10px"><span class="form-title">員工ID：</span><input style="display: block;"
            [(ngModel)]="empIDValue" name="empIDValue"></div>
      </div>
      <div nz-col nzSpan="6">
        <div style="padding:10px"><span class="form-title">是否在職：</span>
          <mat-select [(ngModel)]="on_jobValue" name="on_jobValue"
            style="width:100%;height:25px;border-radius:10px;border:none;padding:4px;background-color:#E6E6E6">
            <mat-option *ngFor="let code of on_jobCode" [value]="code.value">
              {{code.viewValue}}
            </mat-option>
          </mat-select>
        </div>
      </div>
    </div>

    <div nz-row>
      <div nz-col nzSpan="6">
        <div style="padding:10px"><span class="form-title">代理人：</span>
          <mat-select [(ngModel)]="agent_empValue" name="agent_empValue"
            style="width:100%;height:25px;border-radius:10px;border:none;padding:4px;background-color:#E6E6E6">
            <mat-option *ngFor="let code of agent_empCode" [value]="code.value">
              {{code.viewValue}}
            </mat-option>
          </mat-select>
        </div>
      </div>

      <div nz-col nzSpan="6">
        <div style="padding:10px"><span class="form-title">是否停派：</span>
          <mat-select [(ngModel)]="assign_stopValue" name="assign_stopValue"
            style="width:100%;height:25px;border-radius:10px;border:none;padding:4px;background-color:#E6E6E6">
            <mat-option *ngFor="let code of assign_stopCode" [value]="code.value">
              {{code.viewValue}}
            </mat-option>
          </mat-select>
        </div>
      </div>

      <div nz-col nzSpan="6">
        <div style="padding:10px"><span class="form-title">派件專案代碼：</span>
          <mat-select [(ngModel)]="projectValue" name="projectValue"
            style="width:100%;height:25px;border-radius:10px;border:none;padding:4px;background-color:#E6E6E6">
            <mat-option *ngFor="let code of projectCode" [value]="code.value">
              {{code.viewValue}}
            </mat-option>
          </mat-select>
        </div>
      </div>
    </div>
    <div nz-row>
          <div nz-col nzSpan="6">
            <div style="padding:10px"><span class="form-title">請假迄日</span>
              <nz-date-picker style="display:block"  [(ngModel)]="levelStartDateString" name="levelStartDateString" ></nz-date-picker>
            </div>
          </div>

          <div nz-col nzSpan="6">
            <div style="padding:10px"><span class="form-title">請假起日種類</span>
              <mat-select [(ngModel)]="levelStartDateTypeValue" name="levelStartDateTypeValue"
                style="width:100%;height:25px;border-radius:10px;border:none;padding:4px;background-color:#E6E6E6">
                <mat-option *ngFor="let code of levelStartDateTypeCode" [value]="code.value">
                  {{code.viewValue}}
                </mat-option>
              </mat-select>
            </div>
          </div>

          <div nz-col nzSpan="6">
            <div style="padding:10px"><span class="form-title">請假迄日</span>
              <nz-date-picker style="display:block"  [(ngModel)]="levelEndDateString" name="levelEndDateString" ></nz-date-picker>
            </div>
          </div>

          <div nz-col nzSpan="6">
            <div style="padding:10px"><span class="form-title">請假迄日種類</span>
              <mat-select [(ngModel)]="levelEndDateTypeValue" name="levelEndDateTypeValue"
                style="width:100%;height:25px;border-radius:10px;border:none;padding:4px;background-color:#E6E6E6">
                <mat-option *ngFor="let code of levelEndDateTypeCode" [value]="code.value">
                  {{code.viewValue}}
                </mat-option>
              </mat-select>
            </div>
          </div>
    </div>

  </div>


  <!-- 最外層卡片包覆 -->
  <div class="line_bank_card_no_padding">

    <nz-table nzShowSizeChanger [nzData]="employeeSource.data" [nzFrontPagination]="false" [nzSimple]="true"
      [nzLoading]="loading" [nzTotal]="total" [nzPageSize]="pageSize" [nzPageIndex]="pageIndex"
      (nzQueryParams)="onQueryParamsChange($event)" nzSize="small" nzTitle="照會話術設定">
      <thead>
        <tr>
          <th class="table-header">員工編號</th>
          <th class="table-header">員工姓名</th>
          <th class="table-header">員工ID</th>
          <th class="table-header">是否在職</th>
          <th class="table-header">代理人</th>
          <th class="table-header">電子信箱</th>
          <th class="table-header">請假設定</th>
          <th class="table-header">是否停派</th>
          <th class="table-header">派件專案代碼</th>
          <th class="table-header">角色</th>
          <th class="table-header">編輯</th>

        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let data of employeeSource.data">
          <td class="table-data">{{ data.EMP_NO }}</td>
          <td class="table-data">{{ data.EMP_NAME }}</td>
          <td class="table-data">{{ data.EMP_ID }}</td>
          <td class="table-data">{{ getOptionDesc(on_jobCode, data.ON_JOB) }}</td>
          <td class="table-data">{{ getOptionDesc(agent_empCode, data.AGENT_EMP) }}</td>
          <td class="table-data">{{ data.EMAIL }}</td>
          <td class="table-data">{{ getlevelDateData(data.LEAVE_STARTDATE|
            date:"yyyy-MM-dd",data.LEAVE_STARTDATE_TYPE,data.LEAVE_ENDDATE| date:"yyyy-MM-dd",data.LEAVE_ENDDATE_TYPE) }}</td>
          <td class="table-data">{{ getOptionDesc(assign_stopCode, data.ASSIGN_STOP) }}</td>
          <td class="table-data">{{ getOptionDesc(projectCode, data.ASSIGN_PROJECTNO) }}</td>
          <td class="table-data">
            <button nz-button [nzSize]="'middle'" nzType="primary" (click)="setRoleNo
            (data.EMP_NO, data.ROLE_NO)">角色</button>
          </td>
          <td class="table-data">
            <button nz-button [nzSize]="'middle'" nzType="primary" (click)="startEdit(i,
            data.EMP_NO, data.EMP_NAME,data.EMP_ID, data.ON_JOB,data.AGENT_EMP, data.EMAIL,
            data.LEAVE_STARTDATE,data.LEAVE_ENDDATE,data.LEAVE_STARTDATE_TYPE,
            data.LEAVE_ENDDATE_TYPE, data.ASSIGN_STOP,data.ASSIGN_PROJECTNO)">編輯</button>
          </td>
        </tr>
      </tbody>
    </nz-table>
  </div>

</div>











<!-- <div class="container">
  <th class="f03_th">組織人員維護</th>
</div>
<div class="f03_div" style="padding-left: 20px; padding-top: 20px;">
  <button mat-raised-button color="primary" (click)="addNew()">新增</button>
  <button mat-raised-button color="primary" (click)="changeSelect()">查詢</button>
  <button mat-raised-button color="primary" (click)="Clear()">清除資料</button>
</div>
<table style="padding-left: 20px;">
  <br>
  <mat-card class="matCard">
    <mat-card-content>
      <tr>
        <th>員工編號：</th>
        <td>
          <mat-form-field color="accent">
            <input matInput [(ngModel)]="empNoValue">
          </mat-form-field>
        </td>
        <th>員工姓名：</th>
        <td>
          <mat-form-field color="accent">
            <input matInput [(ngModel)]="empNameValue">
          </mat-form-field>
        </td>
        <th>員工ID：</th>
        <td>
          <mat-form-field color="accent">
            <input matInput [(ngModel)]="empIDValue">
          </mat-form-field>
        </td>

      </tr>
      <tr>
        <th>是否在職：</th>
        <td>
          <mat-form-field color="accent">
            <mat-select [(ngModel)]="on_jobValue" name="on_jobCode">
              <mat-option *ngFor="let code of on_jobCode" [value]="code.value">
                {{code.viewValue}}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </td>
        <th>代理人：</th>
        <td>
          <mat-form-field color="accent">
            <mat-select [(ngModel)]="agent_empValue" name="agent_empCode">
              <mat-option *ngFor="let code of agent_empCode" [value]="code.value">
                {{code.viewValue}}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </td>
        <th>E_MAIL：</th>
        <td>
          <mat-form-field color="accent">
            <input matInput [(ngModel)]="emailValue">
          </mat-form-field>
        </td>

      </tr>
      <tr>
        <th>是否停派：</th>
        <td>
          <mat-form-field color="accent">
            <mat-select [(ngModel)]="assign_stopValue" name="assign_stopCode">
              <mat-option *ngFor="let code of assign_stopCode" [value]="code.value">
                {{code.viewValue}}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </td>
        <th>派件專案代碼：</th>
        <td>
          <mat-form-field color="accent">
            <mat-select [(ngModel)]="projectValue" name="projectCode">
              <mat-option *ngFor="let code of projectCode" [value]="code.value">
                {{code.viewValue}}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </td>

      </tr>
      <tr>

        <th>請假設定：</th>
        <td>
          <mat-form-field appearance="fill">
            <mat-label>請假起日</mat-label>
            <input matInput [matDatepicker]="levelStartDateValue" [(ngModel)]="levelStartDateString"
              name="levelStartDateString">
            <mat-datepicker-toggle matSuffix [for]="levelStartDateValue">
            </mat-datepicker-toggle>
            <mat-datepicker #levelStartDateValue></mat-datepicker>
          </mat-form-field>
        </td>


        <td>
          <mat-form-field color="accent" width:100px;>
            <mat-label>請假起日種類</mat-label>
            <mat-select [(ngModel)]="levelStartDateTypeValue" name="levelStartDateTypeCode">
              <mat-option *ngFor="let code of levelStartDateTypeCode" [value]="code.value">
                {{code.viewValue}}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </td>

        <td>
          <mat-form-field appearance="fill">
            <mat-label>請假迄日</mat-label>
            <input matInput [matDatepicker]="levelEndDateValue" [(ngModel)]="levelEndDateString"
              name="levelEndDateString">
            <mat-datepicker-toggle matSuffix [for]="levelEndDateValue"></mat-datepicker-toggle>
            <mat-datepicker #levelEndDateValue></mat-datepicker>
          </mat-form-field>
        </td>

        <td>
          <mat-form-field color="accent" width:100px;>
            <mat-label>請假迄日種類</mat-label>
            <mat-select [(ngModel)]="levelEndDateTypeValue" name="levelEndDateTypeCode">
              <mat-option *ngFor="let code of levelEndDateTypeCode" [value]="code.value">
                {{code.viewValue}}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </td>

      </tr>

    </mat-card-content>
  </mat-card>
</table>

<mat-table [dataSource]="employeeSource" matSort (matSortChange)="changeSort($event)">
  <ng-container matColumnDef="EMP_NO">
    <mat-header-cell *matHeaderCellDef>員工編號</mat-header-cell>
    <mat-cell *matCellDef="let row">{{ row.EMP_NO }}</mat-cell>
  </ng-container>
  <ng-container matColumnDef="EMP_NAME">
    <mat-header-cell *matHeaderCellDef>員工姓名</mat-header-cell>
    <mat-cell *matCellDef="let row">{{ row.EMP_NAME }}</mat-cell>
  </ng-container>
  <ng-container matColumnDef="EMP_ID">
    <mat-header-cell *matHeaderCellDef>員工ID</mat-header-cell>
    <mat-cell *matCellDef="let row">{{ row.EMP_ID }}</mat-cell>
  </ng-container>
  <ng-container matColumnDef="ON_JOB">
    <mat-header-cell *matHeaderCellDef mat-sort-header>是否在職</mat-header-cell>
    <mat-cell *matCellDef="let row">{{ getOptionDesc(on_jobCode, row.ON_JOB) }}</mat-cell>
  </ng-container>
  <ng-container matColumnDef="AGENT_EMP">
    <mat-header-cell *matHeaderCellDef mat-sort-header>代理人</mat-header-cell>
    <mat-cell *matCellDef="let row">{{ getOptionDesc(agent_empCode, row.AGENT_EMP) }}</mat-cell>
  </ng-container>
  <ng-container matColumnDef="EMAIL">
    <mat-header-cell *matHeaderCellDef mat-sort-header>電子信箱</mat-header-cell>
    <mat-cell *matCellDef="let row">{{ row.EMAIL }}</mat-cell>
  </ng-container>
  <ng-container matColumnDef="LEAVE_STARTDATE_LEAVE_ENDDATE">
    <mat-header-cell *matHeaderCellDef mat-sort-header>請假設定</mat-header-cell>
    <mat-cell *matCellDef="let row">{{getlevelDateData(row.LEAVE_STARTDATE|
      date:"yyyy-MM-dd",row.LEAVE_STARTDATE_TYPE,row.LEAVE_ENDDATE| date:"yyyy-MM-dd",row.LEAVE_ENDDATE_TYPE)}}
    </mat-cell>
  </ng-container>
  <ng-container matColumnDef="ASSIGN_STOP">
    <mat-header-cell *matHeaderCellDef mat-sort-header>是否停派</mat-header-cell>
    <mat-cell *matCellDef="let row">{{ getOptionDesc(assign_stopCode, row.ASSIGN_STOP) }}</mat-cell>
  </ng-container>
  <ng-container matColumnDef="ASSIGN_PROJECTNO">
    <mat-header-cell *matHeaderCellDef mat-sort-header>派件專案代碼</mat-header-cell>
    <mat-cell *matCellDef="let row">{{ getOptionDesc(projectCode, row.ASSIGN_PROJECTNO) }}</mat-cell>
  </ng-container>

  <ng-container matColumnDef="ROLE_NO">
    <mat-header-cell *matHeaderCellDef mat-sort-header>角色</mat-header-cell>
    <mat-cell *matCellDef="let row">
      <button mat-raised-button color="primary" (click)="setRoleNo(row.EMP_NO, row.ROLE_NO)">角色</button>
    </mat-cell>
  </ng-container>


  <ng-container matColumnDef="actions">
    <mat-header-cell *matHeaderCellDef>編輯</mat-header-cell>
    <mat-cell *matCellDef="let row; let i=index;">
      <button mat-icon-button color="accent"
        (click)="startEdit(i,
          row.EMP_NO, row.EMP_NAME,row.EMP_ID, row.ON_JOB,row.AGENT_EMP, row.EMAIL, row.LEAVE_STARTDATE,row.LEAVE_ENDDATE,row.LEAVE_STARTDATE_TYPE,row.LEAVE_ENDDATE_TYPE, row.ASSIGN_STOP,row.ASSIGN_PROJECTNO)">
        <mat-icon aria-label="Edit">edit</mat-icon>
      </button>
    </mat-cell>
  </ng-container>
  <mat-header-row
    *matHeaderRowDef="['EMP_NO', 'EMP_NAME','EMP_ID', 'ON_JOB','AGENT_EMP', 'EMAIL', 'LEAVE_STARTDATE_LEAVE_ENDDATE', 'ASSIGN_STOP','ASSIGN_PROJECTNO', 'ROLE_NO', 'actions']">
  </mat-header-row>
  <mat-row
    *matRowDef="let mappingCodeRow; columns: ['EMP_NO', 'EMP_NAME','EMP_ID', 'ON_JOB','AGENT_EMP', 'EMAIL', 'LEAVE_STARTDATE_LEAVE_ENDDATE', 'ASSIGN_STOP','ASSIGN_PROJECTNO', 'ROLE_NO', 'actions']">
  </mat-row>
</mat-table>



<tr>
  <td>
    <mat-paginator #paginator [length]="totalCount" [pageIndex]="0" [pageSize]="10"
      [pageSizeOptions]="[5, 10, 15, 50, 100]" [showFirstLastButtons]="true">
    </mat-paginator>
  </td>
</tr> -->
