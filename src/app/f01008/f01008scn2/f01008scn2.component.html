
<span style="position: fixed;z-index: 1;width: 100%;top:90px;background-color: #fff7e9;">
  <br>
  <br>
  <div class="line_bank_card_no_padding_child" style="margin: 0 auto;">
    <div class="line_bank_form_header_title">申請資訊</div>
    <div nz-row style="padding:5px">
      <div nz-col nzFlex="1">
        <div style="padding:3px"><span class="form-title">案件編號</span><input matInput #input class="form-control"
            [(ngModel)]="applno" [ngStyle]="getStyle(applno)" readonly disabled></div>
      </div>
      <div nz-col nzFlex="1">
        <div style="padding:3px"><span class="form-title">姓名</span><input matInput #input class="form-control"
            [(ngModel)]="cuCName" [ngStyle]="getStyle(cuCName)" readonly disabled></div>
      </div>
      <div nz-col nzFlex="1">
        <div style="padding:3px"><span class="form-title">客戶ID</span><input matInput #input class="form-control"
            [(ngModel)]="custId" [ngStyle]="getStyle(custId)" readonly disabled></div>
      </div>
      <div nz-col nzFlex="1">
        <div style="padding:3px"><span class="form-title">身分證字號</span><input matInput #input class="form-control"
            [(ngModel)]="nationalId" [ngStyle]="getStyle(nationalId)" readonly disabled></div>
      </div>
      <div nz-col nzFlex="1">
        <div style="padding:3px"><span class="form-title">客戶身分名單註記</span><input matInput #input class="form-control"
            value="待確認" readonly disabled></div>
      </div>
      <div nz-col nzFlex="1">
        <div style="padding:3px"><span class="form-title">申請產品</span><input matInput #input class="form-control"
            [(ngModel)]="prodCode" [ngStyle]="getStyle(prodCode)" readonly disabled></div>
      </div>
      <div nz-col nzFlex="1">
        <div style="padding:3px"><span class="form-title">申請金額</span><input matInput #input class="form-control"
            [(ngModel)]="applicationAmount" name="applicationAmount" [ngStyle]="getStyle(applicationAmount)" readonly
            disabled></div>
      </div>
      <div nz-col nzFlex="1">
        <div style="padding:3px"><span class="form-title">徵信修改申請金額</span><input matInput #input class="form-control"
            [(ngModel)]="caApplicationAmount" name="caApplicationAmount" [ngStyle]="getStyle(caApplicationAmount)"
            readonly disabled></div>
      </div>
      <div nz-col nzFlex="1">
        <div style="padding:3px"><span class="form-title">貸款用途</span><input matInput #input class="form-control"
            [(ngModel)]="purposeCode" [ngStyle]="getStyle(purposeCode)" readonly disabled></div>
      </div>
      <!-- <div nz-col nzFlex="1">
        <div style="padding:3px"><span class="form-title">專案名稱</span><input matInput #input class="form-control"
            value="待確認" readonly disabled></div>
      </div> -->
      <div nz-col nzFlex="1">
        <div style="padding:3px"><span class="form-title">行銷代碼</span><input matInput #input class="form-control"
            value="待確認" readonly disabled></div>
      </div>
    </div>
  </div>
</span>
<div style="padding-top: 10px;"></div>
<div class="line_bank_card_no_padding_child" style=" margin:110px auto 0 auto;">
  <div class="line_bank_form_header_title">聯絡資訊</div>
  <div nz-row style="padding:5px">
    <div nz-col nzFlex="1">
      <div style="padding:3px"><span class="form-title">行動電話</span><input matInput #input class="form-control"
          [(ngModel)]="cuMTel" [ngStyle]="getStyle(cuMTel)" readonly disabled></div>
    </div>
    <div nz-col nzFlex="1">
      <div style="padding:3px"><span class="form-title">住宅電話區碼</span><input matInput #input class="form-control"
          [(ngModel)]="cuHTelIno" [ngStyle]="getStyle(cuHTelIno)" readonly disabled></div>
    </div>
    <div nz-col nzFlex="1">
      <div style="padding:3px"><span class="form-title">住宅電話</span><input matInput #input class="form-control"
          [(ngModel)]="cuHTel" [ngStyle]="getStyle(cuHTel)" readonly disabled></div>
    </div>
    <div nz-col nzFlex="1">
      <div style="padding:3px"><span class="form-title">公司電話區碼</span><input matInput #input class="form-control"
          [(ngModel)]="cuCpTelIno" [ngStyle]="getStyle(cuCpTelIno)" readonly disabled></div>
    </div>
    <div nz-col nzFlex="1">
      <div style="padding:3px"><span class="form-title">公司電話</span><input matInput #input class="form-control"
        [(ngModel)]="cuCpTel" [ngStyle]="getStyle(cuCpTel)" readonly disabled></div>
    </div>
    <div nz-col nzFlex="1">
      <div style="padding:3px"><span class="form-title">其他-手機(非本行主要)</span><input matInput #input class="form-control"
          [(ngModel)]="cuMTelOther" [ngStyle]="getStyle(cuMTelOther)" readonly disabled></div>
    </div>
    <div nz-col nzFlex="1">
      <div style="padding:3px"><span class="form-title">其他-聯絡資訊</span><input matInput #input class="form-control"
        [(ngModel)]="contactOther" [ngStyle]="getStyle(contactOther)" readonly disabled></div>
    </div>
    <div nz-col nzFlex="1">
      <div style="padding:3px"><span class="form-title">其他-公司電話分機</span><input matInput #input class="form-control"
        [(ngModel)]="cuCpTelExt" [ngStyle]="getStyle(cuCpTelExt)" readonly disabled></div>
    </div>
  </div>
</div>
<br>
<button style="margin-left: 50px;" nz-button [nzSize]="'middle'" nzType="primary" (click)="add()"
[disabled]="getSearch() == 'Y'">新增照會</button>

<div class="line_bank_card_no_padding">
  <div class="line_bank_form_header_title">照會資訊</div>
  <nz-table nzSize="small" [nzData]="dataSource" (nzQueryParams)="onQueryParamsChange($event)">
    <thead>
      <tr>
        <th class="table-header" style="width:5%">NO</th>
        <th class="table-header" style="width:12.5%">聯絡方式</th>
        <th class="table-header" style="width:10%">手機/市話</th>
        <th class="table-header" style="width:12.5%">電話狀況</th>
        <th class="table-header" style="width:10%">備註</th>
        <th class="table-header" style="width:10%;z-index: 0;" (nzSortOrderChange)="Serial($event)" [nzSortFn]="true"
          [nzSortDirections]="sortArry">確認時間</th>
        <th class="table-header" style="width:10%">設定下次聯絡時間</th>
        <th class="table-header" style="width:10%">確認人員</th>
        <th class="table-header">編輯</th>
        <th class="table-header">刪除</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let data of dataSource;let i =index ">
        <td class="table-data">{{ i+1 }}</td>
        <td class="table-data">{{getOptionDesc(tYPE,data.CON_TYPE)}}</td>
        <td class="table-data">{{data.PHONE}}</td>
        <td class="table-data">{{getOptionDesc(cONDITION,data.TEL_CONDITION)}}</td>
        <td class="table-data">{{data.CON_MEMO}}</td>
        <td class="table-data">{{data.CALLOUT_SETTIME|date:"yyyy-MM-dd HH:mm"}}</td>
        <td class="table-data">{{data.CALLOUT_DATE|date:"yyyy-MM-dd HH:mm"}}</td>
        <td class="table-data">{{data.CALLOUT_EMPNO}}</td>
        <td class="table-data" style="text-align: center;">
          <button *ngIf="lv == 'D2'" nz-button [nzSize]="'middle'" nzType="primary"
            (click)="startEdit(data.ID,data.CON_TYPE,data.CON_MEMO,data.PHONE,data.TEL_CONDITION,data.CALLOUT_SETTIME,data.CALLOUT_DATE)">編輯</button>

          <button *ngIf="lv != 'D2' || getSearch() == 'Y'" nz-button [nzSize]="'middle'" nzType="primary" disabled
            (click)="startEdit(data.ID,data.CON_TYPE,data.CON_MEMO,data.PHONE,data.TEL_CONDITION,data.CALLOUT_SETTIME,data.CALLOUT_DATE)">編輯</button>
        </td>
        <td class="table-data" style="text-align: center;">
          <button *ngIf="lv == 'D2'" nz-button [nzSize]="'middle'" nzDanger
            (click)="deleteItem(data.ID,data.CON_TYPE,data.CON_MEMO,data.PHONE,data.TEL_CONDITION,data.CALLOUT_SETTIME,data.CALLOUT_DATE)">刪除</button>
          <button *ngIf="lv != 'D2' || getSearch() == 'Y'" nz-button nz-button [nzSize]="'middle'" nzDanger
            (click)="deleteItem(ddata.ID,data.CON_TYPE,data.CON_MEMO,data.PHONE,data.TEL_CONDITION,data.CALLOUT_SETTIME,data.CALLOUT_DATE)"
            disabled>刪除</button>
        </td>
      </tr>
    </tbody>
  </nz-table>
</div>
<div class="line_bank_card_no_padding">
  <nz-table nzSize="small" [nzData]="jaicSource" [nzFrontPagination]="false" [nzSimple]="false" nzTemplateMode>
    <thead>
      <th class="table-header-sub" style="width:15%;border-radius: 0px 5px 0px 0px;">
        徵審後處理審核結果
      </th>
      <th class="table-header-sub" style="width:10%;border-radius: 0px 5px 0px 0px;">
        重新發查日期時間
      </th>
      <th class="table-header-sub" style="width:20%;border-radius: 0px 5px 0px 0px;">
        目前已發查次數(最大可發查3次)
      </th>
      <th class="table-header-sub" style="width:60%;border-radius: 0px 5px 0px 0px;"></th>
    </thead>
    <tbody>
      <tr *ngFor="let data of jaicSource;">
        <td>
          <mat-select [(ngModel)]="resulet" name="resulet" (ngModelChange)="storageSeve()" [disabled]="getSearch() == 'Y'">
            <mat-option *ngFor="let code of ResultCode" [value]="code.value">
              {{code.viewValue}}
            </mat-option>
          </mat-select>
        </td>
        <td style="padding: 5px;">
          <nz-date-picker [(ngModel)]="data.researchDate" name="Sendcheck" (ngModelChange)="dataSeve(data.researchDate)"
            [disabled]="lv=='D1' || getSearch() == 'Y'" [nzDisabledDate]="disabledDate">
          </nz-date-picker>
        </td>
        <td style="padding: 5px;">
          <input type="text" value="{{data.researchNum != null? data.researchNum:0}}" disabled>
        </td>
        <td style="padding: 5px;"></td>
      </tr>
    </tbody>
  </nz-table>
</div>
<div class="line_bank_card_no_padding">
  <div class="line_bank_form_header_title">審核結果</div>
  <div nz-row style="padding:5px">
    <div nz-col nzFlex="1">
      <div style="padding:2px"><span class="form-title">核決結果</span>
        <mat-select [(ngModel)]="creditResult" name="creditResult" style="height:25px" disabled>
          <mat-option *ngFor="let code of creditResultCode" [value]="code.value">
            {{code.viewValue}}
          </mat-option>
        </mat-select>
      </div>
    </div>
    <div nz-col nzFlex="1">
      <div style="padding:3px"><span class="form-title">產品代號</span><input matInput #input class="form-control" disabled
          value="待確認" readonly></div>
    </div>
    <div nz-col nzFlex="1">
      <div style="padding:3px"><span class="form-title">專案代號</span><input matInput #input class="form-control" disabled
          value="待確認" readonly></div>
    </div>
    <div nz-col nzFlex="1">
      <div style="padding:3px"><span class="form-title">核准額度</span><input matInput #input class="form-control" disabled
          [(ngModel)]="quota" name="quota" disabled></div>
    </div>
    <div nz-col nzFlex="1">
      <div style="padding:3px"><span class="form-title">每月最低還款比率(%)</span><input matInput #input disabled
          [(ngModel)]="repayment" name="quota" disabled></div>
    </div>
    <div nz-col nzFlex="1">
      <div style="padding:3px"><span class="form-title">人員記錄-PM策略客群</span><input matInput #input disabled></div>
    </div>
    <div nz-col nzFlex="1">
      <div style="padding:3px"><span class="form-title">人員記錄-風險等級</span><input matInput #input class="form-control"
          disabled></div>
    </div>
  </div>
</div>
<!-- 表格 -->
<div class="line_bank_card_no_padding">
  <div class="line_bank_form_header_title">多階利率</div>
  <nz-table nzShowSizeChanger [nzData]="CreditInterestPeriodSource" [nzFrontPagination]="false" [nzSimple]="true"
    (nzQueryParams)="onQueryParamsChange($event)" nzSize="small">
    <thead style="max-height: 100vh;">
      <tr>
        <th class="table-header">序號</th>
        <th class="table-header">分段起始期數</th>
        <th class="table-header">期別</th>
        <th class="table-header">利率型態</th>
        <th class="table-header">當時的指數,基放,郵儲利率(%)</th>
        <th class="table-header">利率(%)</th>
        <th class="table-header">核准利率(%)</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let data of CreditInterestPeriodSource; let i = index">
        <td class="table-data">
          <input matInput #input class="form-control" [(ngModel)]="CreditInterestPeriodSource[i].seq" disabled>
        </td>
        <td class="table-data">
          <input matInput #input class="form-control" [(ngModel)]="data.period" name="period" [disabled]="true">
        </td>
        <td class="table-data">
          <mat-select [(ngModel)]="data.periodType" name="periodType"
            (ngModelChange)="change(data.periodType,'periodType',i + 1)" [disabled]="true">
            <mat-option *ngFor="let code of periodTypeCode" [value]="code.value">
              {{code.viewValue}}
            </mat-option>
          </mat-select>
        </td>
        <td class="table-data">
          <mat-select [(ngModel)]="data.interestType" name="interestType" [disabled]="true">
            <mat-option *ngFor="let code of interestTypeCode" [value]="code.value">
              {{code.viewValue}}
            </mat-option>
          </mat-select>
        </td>
        <td class="table-data">
          <input matInput #input class="form-control" [(ngModel)]="data.interestBase" name="interestBase" readonly>
        </td>
        <td class="table-data">
          <input matInput #input class="form-control" [(ngModel)]="data.interest" name="interest" placeholder="輸入利率"
            style="text-align: right;" [disabled]="true">
        </td>
        <td class="table-data">
          <input matInput #input class="form-control" [(ngModel)]="data.approveInterest" name="approveInterest"
            style="text-align: right;" disabled>
        </td>
      </tr>
    </tbody>
  </nz-table>
</div>

<div class="line_bank_card_no_padding">
  <div class="line_bank_form_header_title">合約資訊</div>
  <div nz-row style="padding:5px">
    <div nz-col nzFlex="1">
      <div style="padding:3px"><span class="form-title">審閱期分類</span><input matInput #input class="form-control"
          [(ngModel)]="revwPrdAbdnDsCd" name="revwPrdAbdnDsCd" disabled></div>
    </div>
    <div nz-col nzFlex="1">
      <div style="padding:3px"><span class="form-title">審閱期開始日</span><input matInput #input class="form-control"
          [(ngModel)]="revwPrdAbdnRegDtm" name="revwPrdAbdnRegDtm" disabled></div>
    </div>
    <div nz-col nzFlex="1">
      <div style="padding:3px"><span class="form-title">合約書版本</span><input matInput #input class="form-control"
         [(ngModel)]="ctrtDocVerId" name="ctrtDocVerId" disabled></div>
    </div>
    <div nz-col nzFlex="1">
      <div style="padding:3px"><span class="form-title">客戶調整後貸款金額</span><input matInput #input class="form-control"
        [(ngModel)]="ajstlnamt" name="ajstlnamt" disabled></div>
    </div>
  </div>
</div>

<div class="line_bank_card_no_padding">
  <nz-table nzSize="small" [nzNoResult]="'  '">
    <thead>
      <th class="table-header-sub" style="width:50%;padding-left:10px;border-radius: 5px 5px 0px 0px;">
        審核註記
      </th>
    </thead>
    <tbody>
      <br>
      <tr style="text-align: center;">
        <td>
          <textarea [(ngModel)]="ma" name="ma" maxlength="300" [disabled]="getSearch() == 'Y'"></textarea>
          <br>
          <button nz-button [nzSize]="'middle'" nzType="primary" (click)="macr()" [disabled]="getSearch() == 'Y'" (keydown.enter)="$event.preventDefault()">儲存</button>
        </td>
      </tr>
    </tbody>
  </nz-table>
</div>
<div class="line_bank_card_no_padding">
  <!-- <nz-table nzSize="small" [nzData]="macrSource" nzTemplateMode>
    <thead>
      <th class="table-header-sub" style="width:10%;border-radius: 5px 0px 0px 0px;">Date</th>
      <th class="table-header-sub" style="width:10%">User</th>
      <th class="table-header-sub" style="max-width: 200px;">>">Action</th>
      <th class="table-header-sub" style="width:10%">Level</th>
    <tbody>
      <tr *ngFor="let data of macrSource;">
        <td class="table-data">{{data.CREDITDATE|date:"yyyy-MM-dd HH:mm"}}</td>
        <td class="table-data">{{data.CREDITUSER}}</td>
        <td class="table-data">{{data.CREDITACTION}}</td>
        <td class="table-data">{{ changeLevel(data.CREDITLEVEL) }}</td>
      </tr>
    </tbody>
  </nz-table> -->
  <nz-table nzShowSizeChanger [nzData]="macrSource" [nzFrontPagination]="false" [nzSimple]="true"

                (nzQueryParams)="onQueryParamsChange($event)" nzSize="small" nzTitle="審核意見">
                <thead>
                    <tr>
                        <th class="table-header">Date</th>
                        <th class="table-header">User</th>
                        <th class="table-header" style="max-width: 200px;">Action</th>
                        <th class="table-header">Level</th>

                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let data of macrSource">
                        <td class="table-data">{{ data.CREDITDATE | date:'yyyy-MM-dd HH:mm:ss' }}</td>
                        <td class="table-data">{{ data.CREDITUSER }}</td>
                        <td class="table-data" style="max-width: 200px;">{{ data.CREDITACTION }}</td>
                        <td class="table-data">{{ changeLevel(data.CREDITLEVEL) }}</td>
                    </tr>
                </tbody>
            </nz-table>
</div>
